<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.1
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h1>Desire</h1>

<p>Desire is a library that provides wrappers around Redis storage types,
as well as composite classes that manage multiple keys and/or types.
Desire currently does not wrap the PUB/SUB commands for a number of reasons:</p>

<ul>
<li>they do not use the same namespace as the storage commands</li>
<li>they are already quite simple to use.</li>
<li>SUBSCRIBE and PSUBSCRIBE block the client</li>
</ul>

<p>That last reason also explains the lack of BLPOP and its pals in Desire::Native::List.</p>

<h2>Overview</h2>

<p>You can instantiate Desire wrappers directly:</p>

<pre class="code ruby"><code><span class='rubyid_hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='rubyid_Desire constant id'>Desire</span><span class='colon2 op'>::</span><span class='rubyid_Hash constant id'>Hash</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_client identifier id'>client</span><span class='comma token'>,</span> <span class='string val'>&quot;some_key&quot;</span><span class='rparen token'>)</span>
</code></pre>

<p>Or use the convenience methods:</p>

<pre class="code ruby"><code><span class='rubyid_desire identifier id'>desire</span> <span class='assign token'>=</span> <span class='rubyid_Desire constant id'>Desire</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_client identifier id'>client</span><span class='rparen token'>)</span> <span class='comment val'># client is duck-typed to redis-rb behavior</span>
<span class='rubyid_hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='rubyid_desire identifier id'>desire</span><span class='dot token'>.</span><span class='rubyid_hash identifier id'>hash</span><span class='lparen token'>(</span><span class='string val'>&quot;some_key&quot;</span><span class='rparen token'>)</span>
</code></pre>

<p>Once you have a wrapper instance, use any Redis method defined for that type:</p>

<pre class="code ruby"><code><span class='rubyid_desire identifier id'>desire</span> <span class='assign token'>=</span> <span class='rubyid_Desire constant id'>Desire</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_redis_client identifier id'>redis_client</span><span class='rparen token'>)</span>
<span class='rubyid_hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='rubyid_desire identifier id'>desire</span><span class='dot token'>.</span><span class='rubyid_hash identifier id'>hash</span><span class='lparen token'>(</span><span class='string val'>&quot;some_key&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_hash identifier id'>hash</span><span class='dot token'>.</span><span class='rubyid_hset identifier id'>hset</span><span class='lparen token'>(</span><span class='string val'>&quot;one_two&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;buckle my shoe&quot;</span><span class='rparen token'>)</span> <span class='comment val'># exact native command</span>
<span class='rubyid_hash identifier id'>hash</span><span class='dot token'>.</span><span class='rubyid_set identifier id'>set</span><span class='lparen token'>(</span><span class='string val'>&quot;three_four&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;shut the door&quot;</span><span class='rparen token'>)</span> <span class='comment val'># same thing, but redundant 'h' prefix removed</span>
</code></pre>

<p>Where possible and sensible, native wrappers alias the names of idiomatic Ruby methods
to the Redis equivalents</p>

<pre class="code ruby"><code><span class='rubyid_hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='string val'>&quot;three_four&quot;</span><span class='rbrack token'>]</span> <span class='comment val'>#=&gt; &quot;shut the door&quot;</span>
<span class='rubyid_hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='string val'>&quot;five_six&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;pick up sticks&quot;</span>
<span class='rubyid_hash identifier id'>hash</span><span class='dot token'>.</span><span class='rubyid_values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='string val'>&quot;one_two&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;seven_eight&quot;</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; [&quot;buckle my shoe&quot;, nil]</span>
</code></pre>

<p>The base Desire class includes the Transaction mixin, which provides #multi
and #watch methods so you can be sure you&#39;re using the right client
at all times in a transaction attempt.</p>

<pre class="code ruby"><code><span class='rubyid_hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='rubyid_desire identifier id'>desire</span><span class='dot token'>.</span><span class='rubyid_hash identifier id'>hash</span><span class='lparen token'>(</span><span class='string val'>&quot;smurf&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_set identifier id'>set</span> <span class='assign token'>=</span> <span class='rubyid_desire identifier id'>desire</span><span class='dot token'>.</span><span class='rubyid_set identifier id'>set</span><span class='lparen token'>(</span><span class='string val'>&quot;seven_dwarfs&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_desire identifier id'>desire</span><span class='dot token'>.</span><span class='rubyid_multi identifier id'>multi</span> <span class='rubyid_do do kw'>do</span>
  <span class='rubyid_hash identifier id'>hash</span><span class='dot token'>.</span><span class='rubyid_hset identifier id'>hset</span><span class='lparen token'>(</span><span class='string val'>&quot;color&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;blue&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_add identifier id'>add</span><span class='lparen token'>(</span><span class='string val'>&quot;grumpy&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</code></pre>

<p>The composite classes provide useful combinations of native features.  The
composite that kicked off the whole project is Desire::SortedHash, which
combines a Hash for data storage with a SortedSet for ordered indexing.</p>

<pre class="code ruby"><code><span class='rubyid_sorted_hash identifier id'>sorted_hash</span> <span class='assign token'>=</span> <span class='rubyid_desire identifier id'>desire</span><span class='dot token'>.</span><span class='rubyid_sorted_hash identifier id'>sorted_hash</span><span class='lparen token'>(</span><span class='string val'>&quot;messages&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_sorted_hash identifier id'>sorted_hash</span><span class='dot token'>.</span><span class='rubyid_set identifier id'>set</span><span class='lparen token'>(</span><span class='rubyid_message_key identifier id'>message_key</span><span class='comma token'>,</span> <span class='rubyid_message_body identifier id'>message_body</span><span class='comma token'>,</span> <span class='rubyid_timestamp identifier id'>timestamp</span><span class='rparen token'>)</span>
</code></pre>

<p>When you instantiate a composite class, the key is treated as a &quot;base key&quot;, i.e.
a string that will serve as the prefix to the actual keys used
within the composite wrapper. A composite class claims the right to all keys
which begin with its base key, so be careful not to use keys that may
collide, either in other Desire composites, or manually.</p>

<pre class="code ruby"><code><span class='rubyid_desire identifier id'>desire</span><span class='dot token'>.</span><span class='rubyid_client identifier id'>client</span><span class='dot token'>.</span><span class='rubyid_keys identifier id'>keys</span><span class='lparen token'>(</span><span class='string val'>&quot;messages.*&quot;</span><span class='rparen token'>)</span>
<span class='comment val'># =&gt; [&quot;messages.index&quot;, &quot;messages.store&quot;]</span>
</code></pre>

<h2>Convention Versioning</h2>

<p>TBW</p>
</div></div>

    <div id="footer">
  Generated on Mon May 21 16:32:11 2012 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.1 (ruby-1.8.7).
</div>

  </body>
</html>